/* Scroogify.js | v0.0.1.pre | https://github.com/ezYZ/scroogify */
(function(e,t){var n={config:{path:"http://src.sencha.io/{{width}}/{{url}}",placeholder:"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",threshold:1024},getPixelRatio:function(){var t=e.devicePixelRatio?e.devicePixelRatio:1;return t},getViewportWidth:function(){return t.documentElement.clientWidth},resizeImages:function(){var e=this.getPixelRatio(),n=this.getViewportWidth(),r=Math.ceil(e*n),i;if(r>this.config.threshold)return;i=t.getElementsByTagName("img");for(var s=0;s<i.length;s++){var o=i[s],u=o.src,a;o.src=this.config.placeholder,a=o.clientWidth>1?Math.ceil(o.clientWidth*e):r,newSrc=this.config.path.replace("{{width}}",a).replace("{{url}}",u),o.src=newSrc}},ready:function(){if(!t.body)return window.setTimeout(n.ready,1);n.init()},updateConfig:function(){var e=t.getElementsByTagName("script"),n,r,i,s;for(var o=0;o<e.length;o++){var u=e[o];if(u.src.indexOf("scroogify")!==-1){n=u;break}}n.hasAttribute("data-placeholder")&&(this.config.placeholder=n.getAttribute("data-placeholder")),n.hasAttribute("data-path")&&(this.config.path=parseInt(n.getAttribute("data-path"))),n.hasAttribute("data-threshold")&&(this.config.threshold=n.getAttribute("data-threshold"))},init:function(){if(this.loaded)return;this.loaded=!0,this.updateConfig(),this.resizeImages()}};t.readyState==="complete"?e.setTimeout(n.ready,1):t.addEventListener?(t.addEventListener("DOMContentLoaded",n.ready,!1),e.addEventListener("load",n.ready,!1)):t.attachEvent&&(t.attachEvent("onreadystatechange",n.ready),e.attachEvent("onload",n.ready))})(this.window,this.document)
